<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Profile â€¢ OuwN</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

    {% if error_msg %}
        <div class="banner-profile err show">{{ error_msg }}</div>
    {% endif %}
    {% if success_msg %}
        <div class="banner-profile ok show">{{ success_msg }}</div>
    {% endif %}

    {% include "header.html" %}
    <nav class="ouwn-breadcrumb-bar" role="navigation" aria-label="Breadcrumb">
      <div class="ouwn-crumbs">
          <a class="crumb" href="{{ url_for('dashboard') }}">
          <i class="fa-solid fa-house"></i>
          <span>Dashboard</span>
          </a>
          <span class="sep" aria-hidden="true">/</span>
          <span class="crumb current" aria-current="page">
          <i class="fa-solid fa-user"></i>
          <span>Profile</span>
          </span>
      </div>
    </nav>

    <main class="auth-container-profile">
       <div class="profile-header">
         <img src="{{ url_for('static', filename='profile.png') }}" alt="Profile Image">
         <h2>Profile Information</h2>
         <button type="button" id="editBtn" class="edit-btn-profile" title="Edit profile"> 
           <i class="fa-solid fa-pen edit-icon"></i>
         </button>
       </div>
        
       <form method="POST" class="profile-info" id="profileForm">
            <input type="hidden" name="action" value="update_profile">
            <p><strong>Name:</strong><br>
            <input type="text" name="name" value="{{ user.Name }}" readonly required></p>
            <p><strong>Username:</strong><br>
            <input type="text" name="username" value="{{ user.UserID }}" readonly required></p>
            <p><strong>Email:</strong><br>
            <input type="email" name="email" value="{{ user.Email }}" readonly required></p>
            
            <div class="action-buttons-profile" id="actionButtons">
                <button type="button" class="btn-profile discard" id="discardBtn">Discard Changes</button>
                <button type="submit" class="btn-profile save">Save Changes</button>
            </div>
        </form>
    </main>

<footer>
  <p>&copy; 2025 OuwN. All Rights Reserved.</p>
</footer>

<script>
// Same JS as your PHP page
const editBtn = document.getElementById('editBtn');
const form = document.getElementById('profileForm');
const inputs = form.querySelectorAll('input:not([type=hidden])');
const actionButtons = document.getElementById('actionButtons');
const discardBtn = document.getElementById('discardBtn');

let isEditing = false;
const originalValues = {};
inputs.forEach(input => originalValues[input.name] = input.value);

editBtn.addEventListener('click', () => {
  if (!isEditing) {
    inputs.forEach(i => i.removeAttribute('readonly'));
    form.classList.add('edit-mode');
    actionButtons.classList.add('show');
    editBtn.style.display = 'none';
    isEditing = true;
  }
});

discardBtn.addEventListener('click', () => {
  inputs.forEach(i => {
    i.value = originalValues[i.name];
    i.setAttribute('readonly', true);
  });
  form.classList.remove('edit-mode');
  actionButtons.classList.remove('show');
  editBtn.style.display = 'block';
  isEditing = false;
});

form.addEventListener('submit', () => {
  inputs.forEach(i => i.setAttribute('readonly', true));
  form.classList.remove('edit-mode');
  actionButtons.classList.remove('show');
  editBtn.style.display = 'block';
  isEditing = false;
});

if (document.querySelector('.banner-profile.err') || document.querySelector('.banner-profile.ok')) {
  const banners = document.querySelectorAll('.banner-profile');
  banners.forEach(banner => {
    banner.classList.add('show');
    setTimeout(() => banner.classList.remove('show'), 4000);
  });
}
</script>
</body>
</html>
