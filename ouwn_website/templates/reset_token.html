<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reset Password</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
      .pw-checklist { list-style:none; padding-left:0; margin-top:8px; }
      .pw-checklist li { margin-bottom:6px; }
      .pw-ok .pw-icon { color: #2e7d32; }
      .pw-bad .pw-icon { color: #f44336; }
      input.is-valid { border-color: #2e7d32; box-shadow: 0 0 0 3px rgba(46,125,50,.25); }
      input.is-invalid { border-color: #e53935; box-shadow: 0 0 0 3px rgba(229,57,53,.25); }
    </style>
</head>
<body class="token-page-body">
    <div class="token-container">
        <h2>Reset Your Password</h2>
        {% if message %}
            <p style="color: {% if '✅' in message %}green{% else %}red{% endif %};">{{ message|safe }}</p>
        {% endif %}
        <form method="POST">
            <input id="password" type="password" name="password" placeholder="Enter new password" required>
            <input type="password" name="confirm_password" placeholder="Confirm new password" required>
            
            <ul class="pw-checklist" id="pwChecklistLive">
              <li data-k="len"><span class="pw-icon">❌</span> At least 8 characters</li>
              <li data-k="upper"><span class="pw-icon">❌</span> Uppercase letter</li>
              <li data-k="lower"><span class="pw-icon">❌</span> Lowercase letter</li>
              <li data-k="digit"><span class="pw-icon">❌</span> Number (0–9)</li>
              <li data-k="special"><span class="pw-icon">❌</span> Special character (!@#…)</li>
            </ul>

            <button type="submit">Update Password</button>
        </form>
        <a href="{{ url_for('Authentication.login') }}">Back to Login</a>
    </div>

<script>
(function(){
    const pw = document.getElementById('password');
    const list = document.getElementById('pwChecklistLive');
    function evalPw(v){return{
        len: v.length>=8,
        upper:/[A-Z]/.test(v),
        lower:/[a-z]/.test(v),
        digit:/\d/.test(v),
        special:/[^A-Za-z0-9]/.test(v)
    };}

    function setRow(k,ok){
        const li = list.querySelector('li[data-k="'+k+'"]');
        if(!li) return;
        li.classList.toggle('pw-ok',ok);
        li.classList.toggle('pw-bad',!ok);
        li.querySelector('.pw-icon').textContent = ok?'✅':'❌';
    }

    pw.addEventListener('input', ()=>{
        const c = evalPw(pw.value);
        ['len','upper','lower','digit','special'].forEach(k=>setRow(k,c[k]));
        pw.classList.toggle('is-invalid',!Object.values(c).every(Boolean)&&pw.value.length>0);
        pw.classList.toggle('is-valid',Object.values(c).every(Boolean));
    });
})();
// Show/hide password checklist on focus/blur
(function() {
  const pw = document.getElementById('password');
  const list = document.getElementById('pwChecklistLive');

  // Hide the checklist initially
  list.style.display = "none";

  // When user clicks (focus) on the password field
  pw.addEventListener('focus', () => {
    list.style.display = "block";
  });

  // When user clicks outside (blur)
  pw.addEventListener('blur', () => {
    // Optional: hide only if password is empty
    if (pw.value.trim() === "") {
      list.style.display = "none";
    }
  });
})();

</script>
</body>
</html>
